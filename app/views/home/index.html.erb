<h1 class="invisible">Tidal Force +</h1>
<div class="flex justify-center items-center">
  <%= image_tag "title.svg", class: "inline-block h-15 object-contain" %>
  <%= image_tag "logo.svg", class: "hidden sm:inline-block sm:h-20 sm:object-contain" %>
</div>
<%= render "layouts/outline" %>

<section class="mb-8">
  <h2 class="invisible">計算の条件</h2>
  <div class="max-w-80 mx-auto">
    <%= form_with method: :get, data: { turbo_frame: "chart_and_list", controller: "timezone session-storage" } do |f| %>
      <div class="mb-1">
        <%= f.label :location, "表示地点：", class: "inline-block w-21" %>
        <%= f.select :location,
              [ [ "根室", "NEMURO" ], [ "秋田", "AKITA" ], [ "東京", "TOKYO" ], [ "小笠原", "OGASAWARA" ], [ "高松", "TAKAMATSU" ], [ "鹿児島", "KAGOSHIMA" ], [ "那覇", "NAHA" ] ],
              { include_blank: true }, data: { session_storage_target: "locationSelect" }, class: "w-36 py-1.5 border rounded-sm" %><br />
      </div>
      <p>表示期間：</p>
      <div class="flex justify-between items-center mb-3">
        <%= f.date_field :first_date, data: { session_storage_target: "firstDateField" }, class: "grow-1 max-w-36 py-1.5 border rounded-sm" %>
        <span class="mx-4">〜</span>
        <%= f.date_field :last_date, data: { session_storage_target: "lastDateField" }, class: "grow-1 max-w-36 py-1.5 border rounded-sm" %>
      </div>
      <%= f.hidden_field :timezone, data: { timezone_target: "timezoneField" } %>
      <div class="flex justify-center">
        <%= f.submit "計算する", { id: "calc_button", data: { action: "click->timezone#setValue click->session-storage#setItem" },
              class: "grow-1 max-w-36 py-1.5 px-4 transition-colors bg-indigo-600 border active:bg-indigo-800 font-medium border-indigo-700 text-white w-45 rounded-sm hover:bg-indigo-700" } %>
      </div>
    <% end %>
  </div>
</section>

<%= turbo_frame_tag "chart_and_list" do %>
  <section class="text-center mb-6 sm:mb-10">
    <h2 class="inline-flex justify-center items-center">
      「起潮力(垂直方向)
      <%= link_to image_tag("link-help.svg"), about_index_path(anchor: "tidal_force"), data: { turbo: false }, class: "link-primary" %>
      」と「木星との距離
      <%= link_to image_tag("link-help.svg"), about_index_path(anchor: "jupiter"), data: { turbo: false }, class: "link-primary" %>
      」
    </h2>
    <div id="chart_vertical" class="h-96 w-full">
      <%= render "chart_vertical" %>
    </div>
  </section>

  <section class="text-center mb-6">
    <h2 class="inline-flex justify-center items-center">
      <span>起潮力(水平方向) の「強さ」と「方位角」</span>
      <%= link_to image_tag("link-help.svg"), about_index_path(anchor: "tidal_force"), data: { turbo: false }, class: "link-primary" %>
    </h2>
    <div id="chart_horizontal" class="h-96 w-full">
      <%= render "chart_horizontal" %>
    </div>
  </section>

  <%= tag.div data: { controller: "calc-results-page #{ user_signed_in? ? "records-page" : "" }" }, class: "max-w-270 mx-auto text-center" do %>
    <div class="inline-flex max-w-full overflow-x-auto">
      <section class="flex-1 overflow-x-auto">
        <h2 class="sticky left-0 text-nowrap">【計算結果】</h2>
        <div>
          <%= render "calc_results" %>
        </div>
      </section>
      <% if user_signed_in? %>
        <section class="flex-3 overflow-x-auto border-l md:flex-4 lg:flex-5 xl:flex-6">
          <h2 class="sticky left-0">【測定結果】</h2>
          <div class="h-261">
            <div class="flex h-20 divide-x-tr">
              <div class="grid grid-rows-3 flex-none items-center justify-center border-b-thead">
                <div class="row-span-2 row-start-2 w-time">time</div>
              </div>
              <div class="grid grid-cols-6 w-records flex-none gap-0.5 pl-0.5 border-b-thead divide-x-tr">
                <%= render partial: "record_titles/record_title", collection: @record_titles %>
              </div>
              <div class="flex">
                <div class="grid grid-rows-3 flex-none justify-center items-center border-b-thead">
                  <div class="row-span-2 row-start-2 w-memo">memo</div>
                </div>
                <div class="w-record-links border-b-thead"></div>
              </div>
            </div>
            <div>
              <%= turbo_frame_tag "records" do %>
                <%= render partial: "records/record", collection: @records %>
              <% end %>
            </div>
          </div>
        </section>
      <% end %>
    </div>
    <div class="sticky bottom-0 bg-white">
      <%= render "pagination" %>
      <% if user_signed_in? %>
        <%= form_with method: :get, data: { records_page_target: "pageForm", turbo_frame: "records" } do |f| %>
          <%= f.hidden_field :page_id, data: { records_page_target: "pageField" } %>
        <% end %>
      <% end %>
    </div>
  <% end %>
<% end %>

<%= render "layouts/terms_and_privacy" %>
